% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/CalculateScores.R
\name{CalculateScores}
\alias{CalculateScores}
\title{Calculate Gene Signature Scores using Score-Based Approaches}
\usage{
CalculateScores(data, metadata, gene_sets, method = c("ssGSEA", "logmedian"))
}
\arguments{
\item{data}{A data frame of normalised (non-transformed) counts where each row is a gene and each column is a sample. The row names should contain gene names
and the column names should contain sample identifiers. \strong{(Required)}}

\item{metadata}{A data frame describing the attributes of each sample. Each row corresponds to a sample and each column to an attribute.
The row names of \code{metadata} must match the sample identifiers (i.e., the column names of \code{data}).
Defaults to \code{NULL} if no metadata is provided.}

\item{gene_sets}{A named list where each element is a vector of gene names corresponding to a gene signature.
The name of each list element should be the label for that signature. \strong{(Required)}}

\item{method}{A character string indicating the scoring method to use. Options are \code{"ssGSEA"}
or \code{"logmedian"}. Defaults to \code{"logmedian"}.}
}
\value{
A list containing the calculated scores for each gene signature. Each element of the list
corresponds to one signature (named accordingly) and is a data frame with the following columns:
\describe{
\item{sample}{The sample identifier (matching the column names of the input data).}
\item{score}{The calculated gene signature score for the corresponding sample.}
\item{\if{html}{\out{<metadata>}}}{Any additional columns from the \code{metadata} data frame provided by the user, if available.}
}
}
\description{
This function calculates a gene signature score for each sample based on one or more predefined gene sets
(signatures). Two methods are available:
}
\details{
\describe{
\item{\code{ssGSEA}}{
Uses the single-sample Gene Set Enrichment Analysis (ssGSEA) method from the
\code{GSVA} package to compute an enrichment score for each signature in each sample.
}
\item{\code{logmedian}}{
Computes, for each sample, the score as the sum of the normalized (log2-median-centered)
expression values of the signature genes divided by the number of genes in the signature.
}
}

\strong{ssGSEA:} This method uses the \code{gsva()} function from the \code{GSVA} package to compute an enrichment score,
representing the absolute enrichment of each gene set in each sample.

\strong{logmedian:} This method log2-transforms the expression values, centers each gene at its median,
and calculates the average of these centered values for the genes in each signature.
}
\examples{
\dontrun{
  # Assume 'gene_data' is your gene expression data frame and 'sample_metadata'
  # is your metadata. Define a list of gene signatures as follows:
  gene_sets <- list(
    "Signature_A" = c("Gene1", "Gene5", "Gene10", "Gene20"),
    "Signature_B" = c("Gene2", "Gene6", "Gene15", "Gene30")
  )

  # Using the ssGSEA method:
  scores_ssgsea <- calculate_signature_score(data = gene_data,
                                             metadata = sample_metadata,
                                             gene_sets = gene_sets,
                                             method = "ssGSEA")

  # Using the logmedian method (default):
  scores_logmedian <- calculate_signature_score(data = gene_data,
                                                gene_sets = gene_sets)
}

}
