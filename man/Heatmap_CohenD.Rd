% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Heatmap_CohenD.R
\name{Heatmap_CohenD}
\alias{Heatmap_CohenD}
\title{Generate Heatmaps for Cohen\'s d Effect Sizes using ggplot2}
\usage{
Heatmap_CohenD(
  data,
  metadata,
  gene_sets,
  variable,
  nrow = NULL,
  ncol = NULL,
  limits = NULL,
  widthTitle = 22,
  titlesize = 12,
  ColorValues = NULL,
  title = NULL
)
}
\arguments{
\item{data}{A data frame of gene expression data with genes as rows and samples as columns.
Row names should contain gene names and column names sample identifiers.}

\item{metadata}{A data frame of sample metadata. The first column must contain sample
identifiers matching those in \code{data}.}

\item{gene_sets}{A named list of gene sets. For unidirectional gene sets, each element is a vector of gene names;
for bidirectional gene sets, each element is a data frame with the first column as gene names and the second column as the expected direction
(1 for upregulated, -1 for downregulated).}

\item{variable}{A string specifying the grouping variable in \code{metadata} used for computing Cohen\'s d comparisons.}

\item{nrow}{Optional. An integer specifying the number of rows in the heatmap grid. If \code{NULL}, the number of rows
is computed automatically.}

\item{ncol}{Optional. An integer specifying the number of columns in the heatmap grid. If \code{NULL}, the number of columns
is computed automatically.}

\item{limits}{Optional. A numeric vector of length 2 specifying the color scale limits (e.g., \code{c(min, max)}). If \code{NULL},
the limits are determined from the data.}

\item{widthTitle}{An integer specifying the width used for wrapping gene set signature names in the heatmap titles. Default is 22.}

\item{titlesize}{An integer specifying the text size for each of the heatmap titles. Default is 12.}

\item{ColorValues}{A character vector specifying the colors for the gradient fill in the heatmaps. Default is \code{c("#F9F4AE", "#B44141")}.}

\item{title}{Title for the grid of plots.}
}
\value{
A list with two elements:
\describe{
\item{plt}{A combined heatmap arranged in a grid using \code{ggpubr::ggarrange}.}
\item{data}{A list containing the Cohen\'s d effect sizes and p-values for each gene signature, as computed by \code{CohenD_allConditions}.}
}
}
\description{
This function computes Cohen\'s d effect sizes and corresponding p-values for multiple gene signatures and produces individual heatmaps. Each heatmap displays cell text showing the Cohen\'s d value along with its p-value. The heatmaps are then arranged in a grid layout.
}
\details{
The function first calculates Cohen\'s d effect sizes and corresponding p-values for each gene signature using \code{CohenD_allConditions} (assumed to be defined elsewhere in the package). The resulting matrices are converted to a long format so that each cell in the heatmap can display the Cohen\'s d value and its associated p-value (formatted as \code{Cohen\'s d (p-value)}).

The heatmaps are then adjusted to display axis text and ticks only for the left-most column and bottom row, and combined into a grid layout. If neither \code{nrow} nor \code{ncol} are specified, the layout is automatically determined to best approximate a square grid.
}
\examples{
\dontrun{
  # Assuming gene_data, sample_metadata, and gene_sets are defined:
  result <- Heatmap_CohenD_ggplot(
    data = gene_data,
    metadata = sample_metadata,
    gene_sets = gene_sets,
    variable = "Condition",
    nrow = 2,
    ncol = 3,
    limits = c(-1, 1),
    widthTitle = 30,
    titlesize = 14,
    ColorValues = c("#F9F4AE", "#B44141")
  )
  print(result$plt)
}

}
\seealso{
\code{\link{CohenD_allConditions}}, \code{\link{wrap_title}}
}
