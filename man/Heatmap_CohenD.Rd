% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Heatmap_CohenD.R
\name{Heatmap_CohenD}
\alias{Heatmap_CohenD}
\title{Generate Heatmaps for Cohen's d Effect Sizes}
\usage{
Heatmap_CohenD(
  data,
  metadata,
  gene_sets,
  variable,
  orientation = c("grid", "horizontal", "vertical"),
  limits = NULL,
  cluster_columns = TRUE,
  cluster_rows = TRUE,
  subtitlewidth = 20
)
}
\arguments{
\item{data}{A data frame of gene expression data with genes as rows and samples as columns.
The row names should contain gene names and the column names sample identifiers.}

\item{metadata}{A data frame of sample metadata. The first column must contain sample identifiers matching \code{data}.}

\item{gene_sets}{A named list of gene sets. For unidirectional gene sets, each element is a vector of gene names;
for bidirectional gene sets, each element is a data frame with the first column as gene names and the second column as the expected direction (1 for upregulated, -1 for downregulated).}

\item{variable}{A string specifying the grouping variable in \code{metadata} used for computing Cohen's d comparisons.}

\item{orientation}{A string indicating the layout of the combined heatmaps. Options are \code{\"grid\"}, \code{\"horizontal\"}, or \code{\"vertical\"}.
Defaults to \code{\"grid\"}.}

\item{limits}{An optional numeric vector specifying the color scale limits (e.g., \code{c(min, max)}). If not provided, the limits are computed from the data.}

\item{cluster_columns}{Logical; whether to cluster columns in the heatmaps. Defaults to \code{TRUE}.}

\item{cluster_rows}{Logical; whether to cluster rows in the heatmaps. Defaults to \code{TRUE}.}

\item{subtitlewidth}{An integer specifying the width used in wrapping the gene set signature names for the heatmap subtitle.}
}
\value{
Depending on the orientation, a combined heatmap object is returned:
\describe{
\item{grid}{A grid-arranged grob (produced by \code{grid.arrange}) of heatmaps.}
\item{horizontal or vertical}{A combined Heatmap object (if not converted to a grob).}
}
}
\description{
Creates heatmaps for Cohen's d effect sizes (and corresponding p-values, shown in cell text) for each gene signature,
and combines them according to the specified orientation.
}
\details{
This function first computes Cohen's d effect sizes and p-values for all gene signatures using \code{CohenD_allConditions}.
It then generates individual heatmaps (with cell text showing \"Cohen's d (p-value)\") for each signature.
Finally, based on the specified \code{orientation}, the heatmaps are combined into a single plot using either
\code{grid.arrange} (for a grid layout) or horizontal/vertical stacking operators.
}
\examples{
\dontrun{
  # Assume gene_data, sample_metadata, and gene_sets are defined
  Heatmap_CohenD(data = gene_data, metadata = sample_metadata,
                 gene_sets = gene_sets, variable = \"Condition\", orientation = \"grid\")
}

}
