% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/PlotScores.R
\name{PlotScores}
\alias{PlotScores}
\title{Plot Gene Signature Scores as Violin Plots}
\usage{
PlotScores(
  ResultsList,
  ColorVariable = NULL,
  GroupingVariable,
  method = c("ssGSEA", "logmedian", "ranking"),
  ColorValues = NULL,
  ConnectGroups = FALSE,
  ncol = NULL,
  nrow = NULL,
  title = NULL,
  widthTitle = 10,
  titlesize = 12,
  y_limits = NULL,
  legend_nrow = NULL,
  pointSize = 2,
  xlab = NULL,
  labsize = 10,
  cond_cohend = NULL
)
}
\arguments{
\item{ResultsList}{A named list where each element is a data frame containing the calculated scores for a gene signature.
Each data frame must have a column named \code{sample} (matching the sample identifiers from the expression data)
and a column named \code{score}. Additional columns (e.g., metadata such as \code{Condition}, \code{Genotype}, etc.)
can be included, by running \code{CalculateScores} accordingly. \strong{(Required)}}

\item{ColorVariable}{A character string indicating the column name used to color the points.
If \code{NULL} (default), the "Paired" brewer pallette is applied.}

\item{GroupingVariable}{A character string indicating the column name in each data frame that will be used for grouping
on the x-axis. \strong{(Required)}}

\item{method}{A character string indicating the scoring method used when running \code{CalculateScores}. Options are \code{"ssGSEA"},
\code{"logmedian"} or \code{"ranking"}. \strong{This argument is mandatory.}}

\item{ColorValues}{An optional named vector that maps the unique values of \code{ColorVariable} to specific colors.
If not provided, a default brewer palette ("Paired") will be used.}

\item{ConnectGroups}{A logical value indicating whether to connect groups using lines across the x-axis.
If \code{TRUE}, a line connecting the median values across groups will be drawn, colored by \code{ColorVariable}.
Default is \code{FALSE}. \strong{(Optional)}}

\item{ncol}{An optional numeric value specifying the number of columns in the grid layout for the combined plots.
If not provided, the function will compute a near-square grid (e.g., for 20 signatures, a 4x5 or 5x4 grid).}

\item{nrow}{An optional numeric value specifying the number of rows in the grid layout. If not provided,
it is computed based on the number of signatures and \code{ncol}.}

\item{title}{A string specifying the main title of the grid of plots.}

\item{widthTitle}{An optional integer specifying the maximum width of the title before inserting line breaks.
Titles will break at \verb{_}, \code{-}, or \code{:} where possible, or at the exact width if no such character is found.
Default is 10.}

\item{titlesize}{Numeric; font size of the main title of the grid of plots (default = \code{14}).}

\item{y_limits}{An optional numeric vector of length 2 specifying the limits of the y-axis. If \code{NULL}, the y-axis will adjust automatically.
\strong{(Optional)}}

\item{legend_nrow}{An optional numeric value specifying the number of rows in the legend. If \code{NULL}, the default number of rows is determined by ggplot2.
\strong{(Optional)}}

\item{pointSize}{An optional numeric value specifying the size of the points. If \code{NULL}, the default number is 2.
\strong{(Optional)}}

\item{xlab}{Optional parameter, specifying the name of the x label. Default is the name of the Grouping Variable
\strong{(Optional)}}

\item{labsize}{Numeric; font size of the plot's axis labels (default = \code{14}).}

\item{cond_cohend}{An optional named list specifying the two groups for which Cohen's d effect size should be calculated.
The list should contain exactly two named elements (e.g., \code{list("GroupA" = c("Condition1"), "GroupB" = c("Condition2", "Condition3"))}).
If not provided, Cohen's d is not computed. Currently only working for two groups. \strong{(Optional)}}
}
\value{
A combined ggplot object (created using \code{ggpubr::ggarrange} and \code{ggpubr::annotate_figure})
that displays a grid of violin plots. Each plot corresponds to one gene signature.
}
\description{
This function generates violin plots (with overlaid jittered points, median summary crossbars,
and optional group connection lines) for each gene signature provided in \code{ResultsList}.
Each element in \code{ResultsList} should be a data frame with at least the following columns:
\code{sample} (sample identifier) and \code{score} (the calculated gene signature score).
Any additional metadata columns will be added to the plots if available.
}
\details{
For each gene signature in \code{ResultsList}, the function creates a violin plot using \code{ggplot2}.
The x-axis is determined by the grouping variable (e.g., \code{Condition}), while the y-axis shows the signature score.
Jittered points are overlaid and optionally colored by \code{ColorVariable}. A median summary is added as a crossbar.
If \code{ConnectGroups = TRUE}, median values across groups are connected with lines, colored by \code{ColorVariable}.

The individual plots are arranged into a grid using \code{ggpubr::ggarrange}, with a near-square layout if
\code{ncol} and \code{nrow} are not explicitly provided.
}
