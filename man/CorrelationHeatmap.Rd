% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/CorrelationHeatmap.R
\name{CorrelationHeatmap}
\alias{CorrelationHeatmap}
\title{Generate a Correlation Heatmap}
\usage{
CorrelationHeatmap(
  data,
  metadata = NULL,
  genes,
  separate.by = NULL,
  method = "pearson",
  plot = TRUE,
  colorlist = list(low = "blue", mid = "white", high = "red"),
  limits_colorscale = NULL,
  widthTitle = 16,
  ncol = NULL,
  nrow = NULL,
  detailedresults = FALSE,
  title = NULL
)
}
\arguments{
\item{data}{A numeric matrix or data frame where rows represent genes and columns represent samples.}

\item{metadata}{Optional. A data frame containing metadata information for the samples.
The first column must contain sample IDs matching the column names in \code{data}.}

\item{genes}{A character vector of gene names to include in the heatmap.}

\item{separate.by}{Optional. A column name from \code{metadata} to separate heatmaps by different conditions.}

\item{method}{Character. Correlation method to be used to compute a correlation matrix using the
\code{corr}function. One of \code{"pearson"} (default), \code{"spearman"}, or \code{"kendall"}.}

\item{plot}{Logical. If \code{TRUE} (default), the resulting heatmap(s) will be displayed.}

\item{colorlist}{Optional. A named list specifying colors for the heatmap gradient.
Default: \code{list(low = "blue", mid = "white", high = "red")}.}

\item{limits_colorscale}{Optional. Numeric vector of length 2 specifying limits for the color scale.
Numbers outside this range will be displayed in grey.}

\item{widthTitle}{Integer. Maximum character width for wrapping plot titles. Default is \code{16}.}

\item{ncol}{Optional. Number of columns for arranging multiple plots when \code{separate.by} is used.}

\item{nrow}{Optional. Number of rows for arranging multiple plots when \code{separate.by} is used.}

\item{detailedresults}{Logical. If \code{TRUE}, additional details including correlation matrices are returned.}

\item{title}{Optional. A character string specifying the title of the heatmap.}
}
\value{
A named list with the following elements:
\describe{
\item{\code{data}}{A data frame containing the transformed correlation values used for plotting.}
\item{\code{plot}}{A ggplot2 plot object or a combined plot (if \code{separate.by} is specified).}
\item{\code{aux}}{A list containing additional data when \code{detailedresults = TRUE}, including:
\describe{
\item{\code{method}}{The correlation method used (\code{"pearson"}, \code{"spearman"}, or \code{"kendall"}).}
\item{\code{corrmatrix}}{A numeric correlation matrix of genes.}
\item{\code{metadata}}{(Only if \code{separate.by} is used) A metadata subset for the condition.}
\item{\code{corrmatrix_ggplot}}{(Only if \code{separate.by} is used) A melted version of \code{corrmatrix} in long format for plotting.}
\item{\code{plot}}{(Only if \code{separate.by} is used) The individual correlation heatmap for the condition.}
}
}
}
}
\description{
This function computes and visualizes a correlation heatmap for a given set of genes.
Optionally, the heatmap can be generated separately for different conditions based on metadata.
}
\examples{
\dontrun{
data <- matrix(rnorm(100), nrow=10, dimnames = list(paste0("Gene", 1:10), paste0("Sample", 1:10)))
metadata <- data.frame(SampleID = paste0("Sample", 1:10), Condition = rep(c("A", "B"), each = 5))
CorrelationHeatmap(data, metadata, genes = rownames(data), separate.by = "Condition")
}

}
