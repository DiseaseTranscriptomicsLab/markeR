% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/FDR_Simulation.R
\name{FDR_Simulation}
\alias{FDR_Simulation}
\title{FDR Simulation Plot}
\usage{
FDR_Simulation(
  data,
  metadata,
  original_signatures,
  GroupingVariable,
  gene_list,
  number_of_sims,
  title_for_plot,
  widthTitle = 10,
  titlesize = 12,
  y_limits = NULL,
  legend_nrow = NULL,
  pointSize = 2,
  xlab = NULL,
  labsize = 10
)
}
\arguments{
\item{metadata}{A data frame containing sample metadata.}

\item{original_signatures}{A named list of gene signatures. Each element can be either a vector of gene names
(implying unidirectionality) or a data frame with columns \code{"Gene"} and \code{"Signal"}.}

\item{GroupingVariable}{Category in which variables should be grouped. This will be used for Cohen's D and PValue Calculations.}

\item{gene_list}{A character vector of gene names from which simulated signatures are generated by sampling.}

\item{number_of_sims}{Integer. The number of simulated signatures to generate per original signature.}

\item{title_for_plot}{Character. A prefix for the plot title. The final title will also include the signature name.}

\item{widthTitle}{Numeric. Maximum width used by the helper function \code{wrap_title} for wrapping titles (default: 10).}

\item{titlesize}{Numeric. Font size for the plot title (default: 12).}

\item{y_limits}{Numeric vector of length 2. Limits for the y-axis in the plots (default: NULL).}

\item{legend_nrow}{Integer. Number of rows to be used for the legend layout (default: NULL).}

\item{pointSize}{Numeric. Size of points in the plot (default: 2).}

\item{xlab}{Character. Label for the x-axis (default: NULL).}

\item{labsize}{Numeric. Font size for axis labels (default: 10).}

\item{counts}{A data frame or matrix of gene expression counts.}
}
\value{
This function prints a combined \code{ggplot} object containing the simulation plots for all gene signatures.
It returns the combined plot invisibly.
}
\description{
This function simulates false discovery rates (FDR) by generating simulated gene signatures and comparing
the observed Cohen's d values of the original signatures to those from simulations. Three scoring methods
(ssGSEA, logmedian, ranking) are used to compute the metrics, and the results are visualized as violin plots
with overlaid observed values.
}
\details{
The function first computes the observed Cohen's d and associated p-values for all original signatures using the
\code{CohenD_allConditions} function. For each signature, a number of simulated signatures are generated by sampling
genes from \code{gene_list}. For each simulation, Cohen's d and p-values are calculated using the same grouping
variable. The simulation results are restructured into a long-format data frame for
plotting. A violin plot is created for each signature, displaying the distribution of simulated Cohen's d values for
each method. A dashed vertical line indicates the 95th percentile (top 5\% threshold) of the simulated distribution, and
the observed value is overlaid as a point, with significance indicated by different point shapes.
}
\examples{
\dontrun{
  # Example usage:
  # Assume `expr_data` is a data frame with gene expression counts,
  # `meta` is a data frame with sample metadata,
  # `orig_sigs` is a named list of gene signatures,
  # and `genes` is a character vector of gene names.

  FDR_Simulation(data = expr_data,
                 metadata = meta,
                 original_signatures = orig_sigs,
                 gene_list = genes,
                 number_of_sims = 100,
                 title_for_plot = "FDR Simulation Plot")
}

}
