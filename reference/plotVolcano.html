<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Volcano Plots from Differential Expression Results — plotVolcano • markeR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Volcano Plots from Differential Expression Results — plotVolcano"><meta name="description" content='This function creates a composite volcano plot grid from a list of differential expression results., or a single
volcano if no genes to highlight are provided and no more than one contrast is used.
For each contrast (provided in DEResultsList) and gene signature (from the genes argument),
a volcano plot is generated using the specified x and y statistics. By default, if invert = FALSE
and more than one gene signature is provided (i.e. the names in genes are not "ALL" or "genes"),
the plots are arranged with gene signatures in rows and contrasts in columns. When invert = TRUE,
the arrangement is reversed (signatures in columns and contrasts in rows). If only one gene signature is provided,
an automatic grid is computed.'><meta property="og:description" content='This function creates a composite volcano plot grid from a list of differential expression results., or a single
volcano if no genes to highlight are provided and no more than one contrast is used.
For each contrast (provided in DEResultsList) and gene signature (from the genes argument),
a volcano plot is generated using the specified x and y statistics. By default, if invert = FALSE
and more than one gene signature is provided (i.e. the names in genes are not "ALL" or "genes"),
the plots are arranged with gene signatures in rows and contrasts in columns. When invert = TRUE,
the arrangement is reversed (signatures in columns and contrasts in rows). If only one gene signature is provided,
an automatic grid is computed.'></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">markeR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Volcano Plots from Differential Expression Results</h1>

      <div class="d-none name"><code>plotVolcano.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function creates a composite volcano plot grid from a list of differential expression results., or a single
volcano if no genes to highlight are provided and no more than one contrast is used.
For each contrast (provided in <code>DEResultsList</code>) and gene signature (from the <code>genes</code> argument),
a volcano plot is generated using the specified x and y statistics. By default, if <code>invert = FALSE</code>
and more than one gene signature is provided (i.e. the names in <code>genes</code> are not "ALL" or "genes"),
the plots are arranged with gene signatures in rows and contrasts in columns. When <code>invert = TRUE</code>,
the arrangement is reversed (signatures in columns and contrasts in rows). If only one gene signature is provided,
an automatic grid is computed.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plotVolcano</span><span class="op">(</span></span>
<span>  <span class="va">DEResultsList</span>,</span>
<span>  genes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  N <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  x <span class="op">=</span> <span class="st">"logFC"</span>,</span>
<span>  y <span class="op">=</span> <span class="st">"-log10(adj.P.Val)"</span>,</span>
<span>  pointSize <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  color <span class="op">=</span> <span class="st">"#6489B4"</span>,</span>
<span>  highlightcolor <span class="op">=</span> <span class="st">"#05254A"</span>,</span>
<span>  highlightcolor_upreg <span class="op">=</span> <span class="st">"#038C65"</span>,</span>
<span>  highlightcolor_downreg <span class="op">=</span> <span class="st">"#8C0303"</span>,</span>
<span>  nointerestcolor <span class="op">=</span> <span class="st">"#B7B7B7"</span>,</span>
<span>  threshold_y <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  threshold_x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  xlab <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ylab <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ncol <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nrow <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  title <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  labsize <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  widthlabs <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  invert <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-deresultslist">DEResultsList<a class="anchor" aria-label="anchor" href="#arg-deresultslist"></a></dt>
<dd><p>A named list of data frames containing differential expression results for each contrast.
Each data frame should have row names corresponding to gene names and include columns for the x and y statistics.
Output from <code>calculateDE</code>.</p></dd>


<dt id="arg-genes">genes<a class="anchor" aria-label="anchor" href="#arg-genes"></a></dt>
<dd><p>Optional. A list of gene signatures to highlight. Each element may be a data frame (in which case its first column is extracted)
or a vector of gene names. If <code>NULL</code>, no genes will be highlighted.</p></dd>


<dt id="arg-n">N<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>Optional. An integer specifying the number of top (and bottom) genes to annotate with text labels.</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Character. The column name in the differential expression results to use for the x-axis (default is <code>"logFC"</code>).</p></dd>


<dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>Character. The column name to use for the y-axis (default is <code>"-log10(adj.P.Val)"</code>). When using this default,
threshold values for <code>threshold_y</code> should be provided in non-log scale (e.g., 0.05).</p></dd>


<dt id="arg-pointsize">pointSize<a class="anchor" aria-label="anchor" href="#arg-pointsize"></a></dt>
<dd><p>Numeric. The size of points in the volcano plots (default is 2).</p></dd>


<dt id="arg-color">color<a class="anchor" aria-label="anchor" href="#arg-color"></a></dt>
<dd><p>Character. The color used to highlight interesting genes based on thresholds (default is <code>"#6489B4"</code>).</p></dd>


<dt id="arg-highlightcolor">highlightcolor<a class="anchor" aria-label="anchor" href="#arg-highlightcolor"></a></dt>
<dd><p>Character. The color used to highlight genes belonging to the specified gene signatures (default is <code>"#05254A"</code>), if direction is not known or not specified.</p></dd>


<dt id="arg-highlightcolor-upreg">highlightcolor_upreg<a class="anchor" aria-label="anchor" href="#arg-highlightcolor-upreg"></a></dt>
<dd><p>Character. The color used to highlight upregulated genes belonging to the specified gene signatures (default is <code>"#038C65"</code>).</p></dd>


<dt id="arg-highlightcolor-downreg">highlightcolor_downreg<a class="anchor" aria-label="anchor" href="#arg-highlightcolor-downreg"></a></dt>
<dd><p>Character. The color used to highlight downregulated genes belonging to the specified gene signatures (default is <code>"#8C0303"</code>).</p></dd>


<dt id="arg-nointerestcolor">nointerestcolor<a class="anchor" aria-label="anchor" href="#arg-nointerestcolor"></a></dt>
<dd><p>Character. The color for non-interesting genes (default is <code>"#B7B7B7"</code>).</p></dd>


<dt id="arg-threshold-y">threshold_y<a class="anchor" aria-label="anchor" href="#arg-threshold-y"></a></dt>
<dd><p>Numeric. A threshold value for the y-axis statistic. If <code>y</code> is <code>"-log10(adj.P.Val)"</code>,
the value should be provided as a non-log value (e.g., 0.05) and will be transformed internally.</p></dd>


<dt id="arg-threshold-x">threshold_x<a class="anchor" aria-label="anchor" href="#arg-threshold-x"></a></dt>
<dd><p>Numeric. A threshold value for the x-axis statistic.</p></dd>


<dt id="arg-xlab">xlab<a class="anchor" aria-label="anchor" href="#arg-xlab"></a></dt>
<dd><p>Optional. A label for the x-axis; if <code>NULL</code>, the value of <code>x</code> is used.</p></dd>


<dt id="arg-ylab">ylab<a class="anchor" aria-label="anchor" href="#arg-ylab"></a></dt>
<dd><p>Optional. A label for the y-axis; if <code>NULL</code>, the value of <code>y</code> is used.</p></dd>


<dt id="arg-ncol">ncol<a class="anchor" aria-label="anchor" href="#arg-ncol"></a></dt>
<dd><p>Optional. The number of columns for arranging plots in the grid. Only applicable if <code>genes</code> is <code>NULL</code>.</p></dd>


<dt id="arg-nrow">nrow<a class="anchor" aria-label="anchor" href="#arg-nrow"></a></dt>
<dd><p>Optional. The number of rows for arranging plots in the grid.</p></dd>


<dt id="arg-title">title<a class="anchor" aria-label="anchor" href="#arg-title"></a></dt>
<dd><p>Optional. A main title for the entire composite plot.</p></dd>


<dt id="arg-labsize">labsize<a class="anchor" aria-label="anchor" href="#arg-labsize"></a></dt>
<dd><p>Numeric. The font size for label annotations (default is 10). The title size will be this value + 4.</p></dd>


<dt id="arg-widthlabs">widthlabs<a class="anchor" aria-label="anchor" href="#arg-widthlabs"></a></dt>
<dd><p>Numeric. The width parameter to pass to the <code><a href="wrap_title.html">wrap_title()</a></code> function for wrapping long labels (default is 20).</p></dd>


<dt id="arg-invert">invert<a class="anchor" aria-label="anchor" href="#arg-invert"></a></dt>
<dd><p>Logical. If <code>FALSE</code> (default), the grid is arranged with gene signatures in rows and contrasts in columns.
If <code>TRUE</code>, the arrangement is inverted (gene signatures in columns and contrasts in rows).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A composite plot (a ggplot object) arranged as a grid of volcano plots with annotated labels.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function generates a volcano plot for each combination of gene signature (from <code>genes</code>) and contrast
(from <code>DEResultsList</code>). It uses the specified <code>x</code> and <code>y</code> statistics to plot points via <code>ggplot2</code>.
Non-interesting genes are plotted using <code>nointerestcolor</code>, while genes in the specified gene signature (if not "ALL")
are highlighted using <code>highlightcolor</code>. Optionally, the top and bottom <code>N</code> genes can be annotated with text labels
(using <code><a href="https://ggrepel.slowkow.com/reference/geom_text_repel.html" class="external-link">ggrepel::geom_text_repel</a></code>). Threshold lines for the x and/or y axes are added if <code>threshold_x</code> or <code>threshold_y</code>
are provided. The individual plots are arranged into a grid using <code><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html" class="external-link">ggpubr::ggarrange</a></code> and annotated with labels using
<code><a href="https://rpkgs.datanovia.com/ggpubr/reference/annotate_figure.html" class="external-link">ggpubr::annotate_figure</a></code> and <code><a href="https://rdrr.io/r/grid/grid.text.html" class="external-link">grid::textGrob</a></code>. The custom <code><a href="wrap_title.html">wrap_title()</a></code> function is used to wrap long labels.</p>
<p>Additionally, the function allows:</p>
<ul><li><p>Plotting of differentially expressed genes based on provided statistics (e.g., <code>x = "logFC"</code> and <code>y = "-log10(adj.P.Val)"</code>).</p></li>
<li><p>Coloring of non-interesting genes and highlighting genes belonging to specific gene signatures.</p></li>
<li><p>Annotation of the top <code>N</code> genes with text labels (using <code><a href="https://ggrepel.slowkow.com/reference/geom_text_repel.html" class="external-link">ggrepel::geom_text_repel</a></code>).</p></li>
<li><p>Addition of threshold lines for the x and/or y axes.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Create example data:</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">100</span>, ncol <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"gene"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"sample"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">metadata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example differential expression results (for two contrasts):</span></span></span>
<span class="r-in"><span><span class="va">de_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  Contrast1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>logFC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>, `-log10(adj.P.Val)` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0</span>, <span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                         row.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"gene"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  Contrast2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>logFC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>, `-log10(adj.P.Val)` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0</span>, <span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                         row.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"gene"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Basic volcano plot grid with default settings:</span></span></span>
<span class="r-in"><span><span class="fu">plotVolcano</span><span class="op">(</span><span class="va">de_results</span>, genes <span class="op">=</span> <span class="cn">NULL</span>, N <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>            x <span class="op">=</span> <span class="st">"logFC"</span>, y <span class="op">=</span> <span class="st">"-log10(adj.P.Val)"</span>, pointSize <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>            color <span class="op">=</span> <span class="st">"#6489B4"</span>, highlightcolor <span class="op">=</span> <span class="st">"#05254A"</span>, nointerestcolor <span class="op">=</span> <span class="st">"#B7B7B7"</span>,</span></span>
<span class="r-in"><span>            threshold_y <span class="op">=</span> <span class="cn">NULL</span>, threshold_x <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>            xlab <span class="op">=</span> <span class="cn">NULL</span>, ylab <span class="op">=</span> <span class="cn">NULL</span>, ncol <span class="op">=</span> <span class="cn">NULL</span>, nrow <span class="op">=</span> <span class="cn">NULL</span>, title <span class="op">=</span> <span class="st">"Volcano Plot Grid"</span>,</span></span>
<span class="r-in"><span>            labsize <span class="op">=</span> <span class="fl">10</span>, widthlabs <span class="op">=</span> <span class="fl">20</span>, invert <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rita Martins-Silva, Alexandre Kaizeler, Nuno Luís Barbosa-Morais.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

