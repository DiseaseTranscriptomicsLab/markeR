<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Alternative Implementation of Single-Sample Gene Set Enrichment Analysis (ssGSEA) — ssGSEA_alternative • markeR</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Alternative Implementation of Single-Sample Gene Set Enrichment Analysis (ssGSEA) — ssGSEA_alternative"><meta name="description" content="This function computes an enrichment score for each sample using an alternative single-sample Gene Set Enrichment Analysis (ssGSEA) method.
It first maps gene sets to the gene indices present in the expression matrix, then ranks the genes for each sample, and finally calculates
a weighted enrichment score based on the cumulative differences between in-set and out-of-set gene ranks.
Source: https://rpubs.com/pranali018/SSGSEA"><meta property="og:description" content="This function computes an enrichment score for each sample using an alternative single-sample Gene Set Enrichment Analysis (ssGSEA) method.
It first maps gene sets to the gene indices present in the expression matrix, then ranks the genes for each sample, and finally calculates
a weighted enrichment score based on the cumulative differences between in-set and out-of-set gene ranks.
Source: https://rpubs.com/pranali018/SSGSEA"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">markeR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/DiseaseTranscriptomicsLab/markeR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Alternative Implementation of Single-Sample Gene Set Enrichment Analysis (ssGSEA)</h1>
      <small class="dont-index">Source: <a href="https://github.com/DiseaseTranscriptomicsLab/markeR/blob/main/R/ssGSEA_alternative.R" class="external-link"><code>R/ssGSEA_alternative.R</code></a></small>
      <div class="d-none name"><code>ssGSEA_alternative.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function computes an enrichment score for each sample using an alternative single-sample Gene Set Enrichment Analysis (ssGSEA) method.
It first maps gene sets to the gene indices present in the expression matrix, then ranks the genes for each sample, and finally calculates
a weighted enrichment score based on the cumulative differences between in-set and out-of-set gene ranks.
Source: https://rpubs.com/pranali018/SSGSEA</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ssGSEA_alternative</span><span class="op">(</span><span class="va">X</span>, <span class="va">gene_sets</span>, alpha <span class="op">=</span> <span class="fl">0.25</span>, scale <span class="op">=</span> <span class="cn">T</span>, norm <span class="op">=</span> <span class="cn">F</span>, single <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">X<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A numeric matrix of gene expression values with rows representing genes and columns representing samples. Row names should correspond to gene identifiers.</p></dd>


<dt id="arg-gene-sets">gene_sets<a class="anchor" aria-label="anchor" href="#arg-gene-sets"></a></dt>
<dd><p>A list of gene sets, where each element is a vector of gene identifiers. The function will match these identifiers with the row names of <code>X</code>.</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>A numeric value specifying the exponent used to weight the ranking scores. Default is <code>0.25</code>.</p></dd>


<dt id="arg-scale">scale<a class="anchor" aria-label="anchor" href="#arg-scale"></a></dt>
<dd><p>Logical; if <code>TRUE</code>, the cumulative difference is normalized by the total number of genes. Default is <code>TRUE</code>.</p></dd>


<dt id="arg-norm">norm<a class="anchor" aria-label="anchor" href="#arg-norm"></a></dt>
<dd><p>Logical; if <code>TRUE</code>, the enrichment scores are further normalized by the absolute difference between the maximum and minimum scores. Default is <code>FALSE</code>.</p></dd>


<dt id="arg-single">single<a class="anchor" aria-label="anchor" href="#arg-single"></a></dt>
<dd><p>Logical; if <code>TRUE</code>, the function returns the sum of the cumulative differences as the enrichment score. If <code>FALSE</code>, the maximum absolute cumulative difference is used. Default is <code>TRUE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A matrix of enrichment scores with rows corresponding to gene sets and columns corresponding to samples.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function performs the following steps:</p><ol><li><p>Maps each gene set to the indices of genes in <code>X</code> by matching gene identifiers.</p></li>
<li><p>Computes column-wise rankings for the gene expression matrix using a ranking method (via the <code>colRanking</code> function) with tie resolution set to <code>'average'</code>.</p></li>
<li><p>For each sample, orders the gene ranks in decreasing order.</p></li>
<li><p>For each gene set in the sample, calculates:</p><ul><li><p>The weighted contribution (<code>rank_alpha</code>) for genes in the set raised to the power of <code>alpha</code>.</p></li>
<li><p>The cumulative distribution functions (CDFs) for genes within the gene set (<code>step_cdf_pos</code>) and those not in the gene set (<code>step_cdf_neg</code>).</p></li>
<li><p>The difference between these CDFs, optionally scaled by the number of genes if <code>scale = TRUE</code>.</p></li>
<li><p>Depending on the <code>single</code> parameter, either the sum of the differences (if <code>TRUE</code>) or the maximum absolute difference (if <code>FALSE</code>) is used as the enrichment score for that gene set.</p></li>
</ul></li>
<li><p>Optionally normalizes the final enrichment scores by the range of values if <code>norm = TRUE</code>.</p></li>
</ol></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span>  <span class="co"># Create a sample gene expression matrix:</span></span></span>
<span class="r-in"><span>  <span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">100</span>, ncol <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"gene"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Define example gene sets:</span></span></span>
<span class="r-in"><span>  <span class="va">gene_sets</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    set1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>, <span class="fl">10</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    set2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>, <span class="fl">15</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Compute the ssGSEA enrichment scores:</span></span></span>
<span class="r-in"><span>  <span class="va">es</span> <span class="op">&lt;-</span> <span class="fu">ssGSEA_alternative</span><span class="op">(</span><span class="va">X</span>, <span class="va">gene_sets</span>, alpha <span class="op">=</span> <span class="fl">0.25</span>, scale <span class="op">=</span> <span class="cn">TRUE</span>, norm <span class="op">=</span> <span class="cn">FALSE</span>, single <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">es</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rita Martins-Silva, Alexandre Kaizeler, Nuno Luís Barbosa-Morais.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

