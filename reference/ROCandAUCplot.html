<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>ROC and AUC Plot Function — ROCandAUCplot • markeR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="ROC and AUC Plot Function — ROCandAUCplot"><meta name="description" content="This function computes ROC curves and AUC values for each gene based on gene expression data and sample metadata.
It can generate ROC plots, an AUC heatmap, or both arranged side‐by‐side."><meta property="og:description" content="This function computes ROC curves and AUC values for each gene based on gene expression data and sample metadata.
It can generate ROC plots, an AUC heatmap, or both arranged side‐by‐side."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">markeR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/DiseaseTranscriptomicsLab/markeR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>ROC and AUC Plot Function</h1>
      <small class="dont-index">Source: <a href="https://github.com/DiseaseTranscriptomicsLab/markeR/blob/v0.9.0/R/ROCandAUCplot.R" class="external-link"><code>R/ROCandAUCplot.R</code></a></small>
      <div class="d-none name"><code>ROCandAUCplot.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function computes ROC curves and AUC values for each gene based on gene expression data and sample metadata.
It can generate ROC plots, an AUC heatmap, or both arranged side‐by‐side.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ROCandAUCplot</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">metadata</span>,</span>
<span>  genes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">condition_var</span>,</span>
<span>  <span class="va">class</span>,</span>
<span>  group_var <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  plot_type <span class="op">=</span> <span class="st">"roc"</span>,</span>
<span>  title <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  widthTitle <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  roc_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  heatmap_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  commomplot_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data frame or matrix containing gene expression data, with genes as rows and samples as columns.</p></dd>


<dt id="arg-metadata">metadata<a class="anchor" aria-label="anchor" href="#arg-metadata"></a></dt>
<dd><p>A data frame containing sample metadata. The first column should contain sample identifiers that match the column names of <code>data</code>.</p></dd>


<dt id="arg-genes">genes<a class="anchor" aria-label="anchor" href="#arg-genes"></a></dt>
<dd><p>A character vector specifying which genes to plot. If <code>NULL</code> (default), all genes in <code>data</code> are used.
A warning is issued if more than 30 genes are selected.</p></dd>


<dt id="arg-condition-var">condition_var<a class="anchor" aria-label="anchor" href="#arg-condition-var"></a></dt>
<dd><p>A character string specifying the column name in <code>metadata</code> representing the condition of interest.
(Mandatory; no default.)</p></dd>


<dt id="arg-class">class<a class="anchor" aria-label="anchor" href="#arg-class"></a></dt>
<dd><p>A character string or vector specifying the positive class label for the condition.
(Mandatory; no default.)</p></dd>


<dt id="arg-group-var">group_var<a class="anchor" aria-label="anchor" href="#arg-group-var"></a></dt>
<dd><p>An optional character string specifying the column name in <code>metadata</code> used for grouping samples (e.g., cell types).
If not provided (<code>NULL</code>), all samples are treated as a single group.</p></dd>


<dt id="arg-plot-type">plot_type<a class="anchor" aria-label="anchor" href="#arg-plot-type"></a></dt>
<dd><p>A character string indicating which plot(s) to generate.
Accepted values are <code>"roc"</code> (only ROC curves), <code>"heatmap"</code> (only the AUC heatmap), or <code>"all"</code> (both arranged side-by-side).
Default is <code>"roc"</code>.</p></dd>


<dt id="arg-title">title<a class="anchor" aria-label="anchor" href="#arg-title"></a></dt>
<dd><p>An optional character string specifying a custom title for the plot(s). If not provided, default titles are generated.</p></dd>


<dt id="arg-widthtitle">widthTitle<a class="anchor" aria-label="anchor" href="#arg-widthtitle"></a></dt>
<dd><p>A numeric value used when wrapping the title. Default is <code>16</code>.</p></dd>


<dt id="arg-roc-params">roc_params<a class="anchor" aria-label="anchor" href="#arg-roc-params"></a></dt>
<dd><p>A list of additional parameters for customizing the ROC plot. Possible elements include:</p><dl><dt><code>nrow</code></dt>
<dd><p>An integer specifying the number of rows in the ROC plot grid. If <code>NULL</code> (default), it is calculated automatically.</p></dd>

<dt><code>ncol</code></dt>
<dd><p>An integer specifying the number of columns in the ROC plot grid. If <code>NULL</code> (default), it is calculated automatically.</p></dd>

<dt><code>colors</code></dt>
<dd><p>A named vector of colors for the different groups. If <code>NULL</code> (default), a default color palette is generated.</p></dd>


</dl></dd>


<dt id="arg-heatmap-params">heatmap_params<a class="anchor" aria-label="anchor" href="#arg-heatmap-params"></a></dt>
<dd><p>A list of additional parameters for customizing the AUC heatmap. Possible elements include:</p><dl><dt><code>cluster_rows</code></dt>
<dd><p>Logical; if <code>TRUE</code> (default), rows are clustered.</p></dd>

<dt><code>cluster_columns</code></dt>
<dd><p>Logical; if <code>TRUE</code> (default), columns are clustered.</p></dd>

<dt><code>col</code></dt>
<dd><p>A vector of length 2 of colors to be used for the minimum and maximum values of the color scale. Defaults to <code>c("#FFFFFF", "#21975C")</code>.</p></dd>

<dt><code>limits</code></dt>
<dd><p>A numeric vector of length 2 specifying the minimum and maximum values for the color scale.
If not provided, defaults to <code>c(0.5, 1)</code>.</p></dd>

<dt><code>name</code></dt>
<dd><p>A character string for the legend title of the color scale. Default is <code>"AUC"</code>.</p></dd>

<dt><code>row_names_gp</code></dt>
<dd><p>Optional graphical parameters for row names (passed to <span class="pkg">ComplexHeatmap</span>).</p></dd>

<dt><code>column_names_gp</code></dt>
<dd><p>Optional graphical parameters for column names (passed to <span class="pkg">ComplexHeatmap</span>).</p></dd>


</dl></dd>


<dt id="arg-commomplot-params">commomplot_params<a class="anchor" aria-label="anchor" href="#arg-commomplot-params"></a></dt>
<dd><p>A list of parameters for customizing the layout of the combined plot when <code>plot_type = "all"</code>.
Possible elements include:</p><dl><dt><code>widths</code></dt>
<dd><p>A numeric vector specifying the relative widths of the ROC and heatmap panels.</p></dd>

<dt><code>heights</code></dt>
<dd><p>A numeric vector specifying the relative heights of the panels.</p></dd>


</dl></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Invisibly returns a list containing:</p><dl><dt><code>roc_plot</code></dt>
<dd><p>The <span class="pkg">ggplot2</span> object of the ROC curves (if generated).</p></dd>

<dt><code>heatmap</code></dt>
<dd><p>The <span class="pkg">ComplexHeatmap</span> object (if generated).</p></dd>

<dt><code>combined</code></dt>
<dd><p>The combined grid arrangement (if <code>plot_type = "all"</code>).</p></dd>

<dt><code>auc_values</code></dt>
<dd><p>A data frame with the calculated AUC values.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function processes gene expression data and metadata to compute ROC curves and AUC values for each gene.
Depending on the value of <code>plot_type</code>, it produces ROC plots (using <span class="pkg">ggplot2</span>), an AUC heatmap (using <span class="pkg">ComplexHeatmap</span>),
or both arranged side-by-side (using <span class="pkg">gridExtra</span>). When <code>group_var</code> is not provided, all samples are treated as a single group.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span>  <span class="co"># Example: Generate both ROC plots and heatmap with custom parameters</span></span></span>
<span class="r-in"><span>  <span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">ROCandAUCplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">myData</span>,</span></span>
<span class="r-in"><span>                          metadata <span class="op">=</span> <span class="va">myMetadata</span>,</span></span>
<span class="r-in"><span>                          genes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Gene1"</span>, <span class="st">"Gene2"</span>, <span class="st">"Gene3"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                          condition_var <span class="op">=</span> <span class="st">"Genotype"</span>,</span></span>
<span class="r-in"><span>                          class <span class="op">=</span> <span class="st">"Mutant"</span>,</span></span>
<span class="r-in"><span>                          group_var <span class="op">=</span> <span class="st">"CellType"</span>,</span></span>
<span class="r-in"><span>                          plot_type <span class="op">=</span> <span class="st">"all"</span>,</span></span>
<span class="r-in"><span>                          title <span class="op">=</span> <span class="st">"My Custom Title"</span>,</span></span>
<span class="r-in"><span>                          roc_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                          heatmap_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                          commomplot_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rita Martins-Silva, Alexandre Kaizeler, Nuno Luís Barbosa-Morais.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

