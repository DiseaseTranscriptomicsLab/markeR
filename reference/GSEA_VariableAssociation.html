<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>GSEA Variable Association — GSEA_VariableAssociation • markeR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="GSEA Variable Association — GSEA_VariableAssociation"><meta name="description" content="This function assesses the association between gene expression (or another molecular score)
and metadata variables using differential expression (DE) analysis and Gene Set Enrichment Analysis (GSEA).
It generates all possible contrasts for categorical variables and uses linear modeling for continuous variables."><meta property="og:description" content="This function assesses the association between gene expression (or another molecular score)
and metadata variables using differential expression (DE) analysis and Gene Set Enrichment Analysis (GSEA).
It generates all possible contrasts for categorical variables and uses linear modeling for continuous variables."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">markeR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/DiseaseTranscriptomicsLab/markeR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>GSEA Variable Association</h1>
      <small class="dont-index">Source: <a href="https://github.com/DiseaseTranscriptomicsLab/markeR/blob/0.9.0/R/GSEA_VariableAssociation.R" class="external-link"><code>R/GSEA_VariableAssociation.R</code></a></small>
      <div class="d-none name"><code>GSEA_VariableAssociation.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function assesses the association between gene expression (or another molecular score)
and metadata variables using differential expression (DE) analysis and Gene Set Enrichment Analysis (GSEA).
It generates all possible contrasts for categorical variables and uses linear modeling for continuous variables.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">GSEA_VariableAssociation</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">metadata</span>,</span>
<span>  <span class="va">cols</span>,</span>
<span>  stat <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"simple"</span>, <span class="st">"medium"</span>, <span class="st">"extensive"</span><span class="op">)</span>,</span>
<span>  <span class="va">gene_set</span>,</span>
<span>  nonsignif_color <span class="op">=</span> <span class="st">"grey"</span>,</span>
<span>  signif_color <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>  saturation_value <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sig_threshold <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  widthlabels <span class="op">=</span> <span class="fl">18</span>,</span>
<span>  labsize <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  titlesize <span class="op">=</span> <span class="fl">14</span>,</span>
<span>  pointSize <span class="op">=</span> <span class="fl">5</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A matrix or data frame containing gene expression data, where rows represent genes and columns represent samples.</p></dd>


<dt id="arg-metadata">metadata<a class="anchor" aria-label="anchor" href="#arg-metadata"></a></dt>
<dd><p>A data frame containing sample metadata with at least one column corresponding to the variables of interest.</p></dd>


<dt id="arg-cols">cols<a class="anchor" aria-label="anchor" href="#arg-cols"></a></dt>
<dd><p>A character vector specifying the metadata columns (variables) to analyse.</p></dd>


<dt id="arg-stat">stat<a class="anchor" aria-label="anchor" href="#arg-stat"></a></dt>
<dd><p>Optional. The statistic to use for ranking genes before GSEA. If <code>NULL</code>, it is automatically determined based on the gene set:</p><ul><li><p><code>"B"</code> for gene sets with <strong>no known direction</strong> (vectors).</p></li>
<li><p><code>"t"</code> for <strong>unidirectional</strong> or <strong>bidirectional</strong> gene sets (data frames).</p></li>
<li><p>If provided, this argument overrides the automatic selection.</p></li>
</ul></dd>


<dt id="arg-mode">mode<a class="anchor" aria-label="anchor" href="#arg-mode"></a></dt>
<dd><p>A character string specifying the contrast generation method for categorical variables. Options: <code>"simple"</code>, <code>"medium"</code>, <code>"extensive"</code>. Default is <code>"simple"</code>.</p></dd>


<dt id="arg-gene-set">gene_set<a class="anchor" aria-label="anchor" href="#arg-gene-set"></a></dt>
<dd><p>A named list defining the gene sets for GSEA. <strong>(Required)</strong></p><ul><li><p>If using <strong>unidirectional</strong> gene sets, provide a list where each element is a vector of gene names representing a signature.</p></li>
<li><p>If using <strong>bidirectional</strong> gene sets, provide a list where each element is a data frame:</p></li>
<li><p>The <strong>first column</strong> should contain gene names.</p></li>
<li><p>The <strong>second column</strong> should indicate the expected direction of enrichment (<code>1</code> for upregulated, <code>-1</code> for downregulated).</p></li>
</ul></dd>


<dt id="arg-nonsignif-color">nonsignif_color<a class="anchor" aria-label="anchor" href="#arg-nonsignif-color"></a></dt>
<dd><p>A string specifying the color for the middle of the adjusted p-value gradient. Default is <code>"white"</code>. Lower limit correspond to the value of <code>sig_threshold</code>.</p></dd>


<dt id="arg-signif-color">signif_color<a class="anchor" aria-label="anchor" href="#arg-signif-color"></a></dt>
<dd><p>A string specifying the color for the low end of the adjusted p-value gradient until the value chosen for significance (<code>sig_threshold</code>). Default is <code>"red"</code>.</p></dd>


<dt id="arg-saturation-value">saturation_value<a class="anchor" aria-label="anchor" href="#arg-saturation-value"></a></dt>
<dd><p>A numeric value specifying the lower limit of the adjusted p-value gradient, below which the color will correspond to <code>signif_color</code>. Default is the results' minimum, unless that
value is above the sig_threshold; in that case, it is 0.001.</p></dd>


<dt id="arg-sig-threshold">sig_threshold<a class="anchor" aria-label="anchor" href="#arg-sig-threshold"></a></dt>
<dd><p>A numeric value specifying the threshold for significance visualization in the plot. Default: <code>0.05</code>.</p></dd>


<dt id="arg-widthlabels">widthlabels<a class="anchor" aria-label="anchor" href="#arg-widthlabels"></a></dt>
<dd><p>An integer controlling the maximum width of contrast labels before text wrapping. Default: <code>18</code>.</p></dd>


<dt id="arg-labsize">labsize<a class="anchor" aria-label="anchor" href="#arg-labsize"></a></dt>
<dd><p>An integer controlling the axis text size in the plot. Default: <code>10</code>.</p></dd>


<dt id="arg-titlesize">titlesize<a class="anchor" aria-label="anchor" href="#arg-titlesize"></a></dt>
<dd><p>An integer specifying the plot title size. Default: <code>14</code>.</p></dd>


<dt id="arg-pointsize">pointSize<a class="anchor" aria-label="anchor" href="#arg-pointsize"></a></dt>
<dd><p>Numeric. The size of points in the lollipop plot (default is 5).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with two elements:</p><ul><li><p><code>data</code>: A data frame containing the GSEA results, including normalized enrichment scores (NES), adjusted p-values, and contrasts.</p></li>
<li><p><code>plot</code>: A ggplot2 object visualizing the GSEA results as a lollipop plot.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Example usage with random data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span>  <span class="co"># For reproducibility</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create random gene expression data</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Assign gene identifiers as row names (e.g., Gene1, Gene2, ...)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Gene"</span>, <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create metadata (e.g., group variable)</span></span></span>
<span class="r-in"><span><span class="va">metadata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Define a gene set</span></span></span>
<span class="r-in"><span><span class="va">gene_set</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>SampleSet <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Gene1"</span>, <span class="st">"Gene2"</span>, <span class="st">"Gene3"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Call the GSEA_VariableAssociation function</span></span></span>
<span class="r-in"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">GSEA_VariableAssociation</span><span class="op">(</span><span class="va">data</span>, <span class="va">metadata</span>, cols <span class="op">=</span> <span class="st">"group"</span>, gene_set <span class="op">=</span> <span class="va">gene_set</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>NaNs produced</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Partial NA coefficients for 7 probe(s)</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># View results</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">data</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      pathway      pval      padj    log2err         ES       NES  size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       &lt;char&gt;     &lt;num&gt;     &lt;num&gt;      &lt;num&gt;      &lt;num&gt;     &lt;num&gt; &lt;int&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1: SampleSet 0.2362447 0.2362447 0.03856799 -0.5510356 -1.211158     3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     leadingEdge stat_used Contrast</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          &lt;list&gt;    &lt;char&gt;   &lt;char&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1: Gene2, Gene3         B    A - B</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">plot</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="GSEA_VariableAssociation-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rita Martins-Silva, Alexandre Kaizeler, Nuno Luís Barbosa-Morais.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

