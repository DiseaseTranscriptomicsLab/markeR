<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>FPR Simulation Plot — FPR_Simulation • markeR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="FPR Simulation Plot — FPR_Simulation"><meta name="description" content="This function simulates false positive rates (FPR) by generating simulated gene signatures and comparing
the observed effect size values (Cohen's d or f) of the original signatures to those from simulated signatures.
The effect size is computed using three scoring methods (ssGSEA, logmedian, and ranking), and the results
are visualized as violin plots with overlaid observed values."><meta property="og:description" content="This function simulates false positive rates (FPR) by generating simulated gene signatures and comparing
the observed effect size values (Cohen's d or f) of the original signatures to those from simulated signatures.
The effect size is computed using three scoring methods (ssGSEA, logmedian, and ranking), and the results
are visualized as violin plots with overlaid observed values."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">markeR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/DiseaseTranscriptomicsLab/markeR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>FPR Simulation Plot</h1>
      <small class="dont-index">Source: <a href="https://github.com/DiseaseTranscriptomicsLab/markeR/blob/main/R/FPR_Simulation.R" class="external-link"><code>R/FPR_Simulation.R</code></a></small>
      <div class="d-none name"><code>FPR_Simulation.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function simulates false positive rates (FPR) by generating simulated gene signatures and comparing
the observed effect size values (Cohen's <em>d</em> or <em>f</em>) of the original signatures to those from simulated signatures.
The effect size is computed using three scoring methods (<code>ssGSEA</code>, <code>logmedian</code>, and <code>ranking</code>), and the results
are visualized as violin plots with overlaid observed values.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">FPR_Simulation</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">metadata</span>,</span>
<span>  <span class="va">original_signatures</span>,</span>
<span>  <span class="va">Variable</span>,</span>
<span>  gene_list <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  number_of_sims <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  title <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  widthTitle <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  titlesize <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  pointSize <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  labsize <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  mode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"simple"</span>, <span class="st">"medium"</span>, <span class="st">"extensive"</span><span class="op">)</span>,</span>
<span>  ColorValues <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ncol <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nrow <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data frame or matrix of gene expression values (genes as rows, samples as columns).</p></dd>


<dt id="arg-metadata">metadata<a class="anchor" aria-label="anchor" href="#arg-metadata"></a></dt>
<dd><p>A data frame containing metadata for the samples (columns of <code>data</code>).</p></dd>


<dt id="arg-original-signatures">original_signatures<a class="anchor" aria-label="anchor" href="#arg-original-signatures"></a></dt>
<dd><p>A named list of gene signatures. Each element can be either:</p><ul><li><p>A vector of gene names (unidirectional), or</p></li>
<li><p>A data frame with columns <code>"Gene"</code> and <code>"Signal"</code> for bidirectional signatures.</p></li>
</ul></dd>


<dt id="arg-variable">Variable<a class="anchor" aria-label="anchor" href="#arg-variable"></a></dt>
<dd><p>A column in <code>metadata</code> indicating the variable of interest for grouping or regression.
This can be categorical or numeric.</p></dd>


<dt id="arg-gene-list">gene_list<a class="anchor" aria-label="anchor" href="#arg-gene-list"></a></dt>
<dd><p>A character vector of gene names from which simulated signatures are generated by sampling.
Default is all genes in <code>data</code>.</p></dd>


<dt id="arg-number-of-sims">number_of_sims<a class="anchor" aria-label="anchor" href="#arg-number-of-sims"></a></dt>
<dd><p>Integer. Number of simulated gene signatures to generate per original signature.</p></dd>


<dt id="arg-title">title<a class="anchor" aria-label="anchor" href="#arg-title"></a></dt>
<dd><p>Optional title for the overall plot.</p></dd>


<dt id="arg-widthtitle">widthTitle<a class="anchor" aria-label="anchor" href="#arg-widthtitle"></a></dt>
<dd><p>Integer. Max width for wrapping the title text (default: 30).</p></dd>


<dt id="arg-titlesize">titlesize<a class="anchor" aria-label="anchor" href="#arg-titlesize"></a></dt>
<dd><p>Numeric. Font size for the title text (default: 12).</p></dd>


<dt id="arg-pointsize">pointSize<a class="anchor" aria-label="anchor" href="#arg-pointsize"></a></dt>
<dd><p>Numeric. Size of the points representing simulations (default: 2).</p></dd>


<dt id="arg-labsize">labsize<a class="anchor" aria-label="anchor" href="#arg-labsize"></a></dt>
<dd><p>Numeric. Font size for axis labels (default: 10).</p></dd>


<dt id="arg-mode">mode<a class="anchor" aria-label="anchor" href="#arg-mode"></a></dt>
<dd><p>Character. Type of contrast calculation if <code>Variable</code> is categorical. Options are:</p><ul><li><p><code>"simple"</code>: basic pairwise contrasts,</p></li>
<li><p><code>"medium"</code>: pairwise + comparisons vs group mean,</p></li>
<li><p><code>"extensive"</code>: all possible balanced contrasts,</p></li>
<li><p><code>"none"</code>: Comparing all levels of <code>Variable</code> (default)</p></li>
</ul></dd>


<dt id="arg-colorvalues">ColorValues<a class="anchor" aria-label="anchor" href="#arg-colorvalues"></a></dt>
<dd><p>Named vector of colors for plot points, typically <code>Original</code> and <code>Simulated</code>. If <code>NULL</code>, default colors are used.</p></dd>


<dt id="arg-ncol">ncol<a class="anchor" aria-label="anchor" href="#arg-ncol"></a></dt>
<dd><p>Integer. Number of columns for arranging signature plots in a grid layout. If <code>NULL</code>, layout is auto-calculated.</p></dd>


<dt id="arg-nrow">nrow<a class="anchor" aria-label="anchor" href="#arg-nrow"></a></dt>
<dd><p>Integer. Number of rows for arranging signature plots in a grid layout. If <code>NULL</code>, layout is auto-calculated.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Invisibly returns the combined <code>ggplot</code> object showing observed vs simulated effect sizes.
One violin plot is generated per signature and contrast. Observed values are highlighted and compared
to the simulated distribution. Significance (adjusted p-value ≤ 0.05) is indicated by point shape.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function supports both categorical and numeric variables:</p><ul><li><p>For <strong>categorical variables</strong>, Cohen's <em>d</em> is used and contrasts are defined by the <code>mode</code> parameter, if <code>mode!=none</code>.</p></li>
<li><p>For <strong>numeric variables</strong>, Cohen's <em>f</em> is used to quantify associations through linear modeling.</p></li>
</ul><p>For each original gene signature, a number of simulated signatures are created by sampling genes from <code>gene_list</code>.
Each simulated signature is scored using three methods, and its effect size is computed relative to the variable of interest.
The resulting distributions are shown as violins, overlaid with the observed value from the original signature.
A red dashed line marks the 95th percentile of the simulated distribution per method.</p>
<p>The function internally uses <code><a href="CohenD_allConditions.html">CohenD_allConditions()</a></code> and <code><a href="CohenF_allConditions.html">CohenF_allConditions()</a></code> depending on variable type.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="fu">FPR_Simulation</span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">expression_data</span>,</span></span>
<span class="r-in"><span>  metadata <span class="op">=</span> <span class="va">sample_metadata</span>,</span></span>
<span class="r-in"><span>  original_signatures <span class="op">=</span> <span class="va">my_signatures</span>,</span></span>
<span class="r-in"><span>  Variable <span class="op">=</span> <span class="st">"condition"</span>,</span></span>
<span class="r-in"><span>  number_of_sims <span class="op">=</span> <span class="fl">100</span>,</span></span>
<span class="r-in"><span>  title_for_plot <span class="op">=</span> <span class="st">"Simulation for FPR"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rita Martins-Silva, Alexandre Kaizeler, Nuno Luís Barbosa-Morais.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

